# Aerospike database developer configuration file.

service {
  # In the official Docker image this is usually daemonized, but leaving false is fine.
  run-as-daemon false

  proto-fd-max 1024

  # These paths are relative to the work directory inside the container.
  work-directory /opt/aerospike
  

  # REQUIRED from 7.0+:
  cluster-name langgraph-test
}

mod-lua {
  user-path /opt/aerospike/usr/udf/lua
}

logging {
  # Log file must be an absolute path.
  file /var/log/aerospike/aerospike.log {
    context any info
  }

  console {
    context any info
  }
}

network {
  service {
    address any
    port 3000
  }

  heartbeat {
    mode mesh
    port 3002
    mesh-seed-address-port aerospike 3002
    interval 150
    timeout 10
  }

  fabric {
    port 3001
  }

  # info {
  #   port 3003
  # }
}

# In-memory namespace for your LangGraph / checkpoint tests.
namespace test {
  replication-factor 1

  # TTL support (needed so your saver can send meta["ttl"])
  nsup-period 120      # run namespace supervisor every 120 seconds
  default-ttl 0        # 0 = no default TTL; records live unless client sets TTL

  # Optional but safe: stop writes when system memory is very high.
  stop-writes-sys-memory-pct 90

  storage-engine memory {
    # This is straight from the docs style:
    # 7.0+ in-memory example uses:
    #   storage-engine memory { data-size 4G }
    # We just shrink to 1G for dev.
    data-size 1G
  }
}
